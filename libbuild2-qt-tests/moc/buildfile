# @@ TODO Test generated headers

qt.version = $config.libbuild2_qt_tests.qt

using qt.moc

if ($qt.version == 5)
  import libs = libQt5Core%lib{Qt5Core}
else
  import libs = libQt6Core%lib{Qt6Core}

# Headers, source files.
#
exe{driver}: cxx{driver} hxx{source} {hxx cxx}{sink}

# C++ source files generated by moc.
#
exe{driver}: moc.cxx{moc_source moc_sink}  \
             moc.moc{sink}

# Libraries.
#
exe{driver}: $libs

# Generate:
#
# moc_source.cxx from source.hxx
# moc_sink.cxx   from sink.hxx
# sinc.moc       from sink.cxx
#
moc.cxx{moc_source}: hxx{source}
moc.cxx{moc_sink}:   hxx{sink}
moc.moc{sink}:       cxx{sink}

cxx.poptions += "-I$out_base" "-I$src_base"
